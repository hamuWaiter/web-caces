<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>canvas绘制一个五角星</title>
	<style>
		*{
			margin: 0;
			padding: 0;
		}
		body{
			overflow: hidden;
		}
	</style>
</head>
<body>
	<canvas id="myCanvas">请更换更高版本的浏览器</canvas>
	<script>
	//1. 画布获取以及画布设置
		let canvas = document.getElementById("myCanvas"),
			ctx = canvas.getContext("2d"),
			width = window.innerWidth,
			height = window.innerHeight;
		window.onresize = ()=>{
			width = window.innerWidth;
			height = window.innerHeight;
			canvas.width = width;
			canvas.height = height;
		}
		window.onresize();//进入设置canvas尺寸
		canvas.style.backgroundColor = "#000";
		
		// 创建渐变：
		//渐变的位置是相对于绘图元素对应的，并不是与屏幕固定，
		// 元素鼠标移动绘图不会改变绘制简便的样式
		var grd=ctx.createLinearGradient(0,0,100,0);
		grd.addColorStop(0,"red");
		grd.addColorStop(0.5,"blue");
		grd.addColorStop(1,"green");
		
		function drawStar(x,y,r){
			// 2.路径设置（通过正余弦计算五角星各顶点）
				let sideNum = 5,
				// outer表示外五边形，inner表示内五边形
					//deg表示旋转角，radius边说半径 
					outerDeg = 2*Math.PI/sideNum,
					innerDeg = outerDeg/2,
					//从π/2处的顶点位置开始绘制
					currentDeg = Math.PI/2;
					outerRadius = r,
					innerRadius = outerRadius*Math.sin(innerDeg/2)/Math.sin(innerDeg);//
				
				ctx.save();
				ctx.beginPath();
				// 设置绘制中心
				ctx.translate(x,y);
				// 只能有一个起点，
				ctx.moveTo(outerRadius*Math.cos(currentDeg),-outerRadius*Math.sin(currentDeg));
				
				for(let i = 0; i < sideNum; i++) {
					currentDeg += innerDeg;
					ctx.lineTo(innerRadius*Math.cos(currentDeg),-innerRadius*Math.sin(currentDeg));
					currentDeg += innerDeg;
					ctx.lineTo(outerRadius*Math.cos(currentDeg),-outerRadius*Math.sin(currentDeg));
					
				}
				ctx.closePath();
				ctx.lineWidth = 2;
				ctx.strokeStyle = grd;
				ctx.stroke();
				ctx.restore();
		}
		
		let mouseX,
			mouseY,
			maxRadius = 100,
			minRadius = 10,
			step =4,
			radius = maxRadius;//未点击时星星默认最大
			// 点击后先变小后恢复到最大
		window.onmousemove = function(e){
			mouseX = e.clientX;
			mouseY = e.clientY;
			ctx.clearRect(0,0,width,height);
			drawStar(mouseX,mouseY,radius);
		}
		
		let timer = null;
		window.onmousedown = function(e){
			mouseX = e.clientX;
			mouseY = e.clientY;
			clearInterval(timer);
			timer = null;
			timer = setInterval(()=>{
				if(radius > minRadius) {
					radius -= step;
				}else{
					clearInterval(timer);
					timer = null;
				}
				ctx.clearRect(0,0,width,height);
				drawStar(mouseX,mouseY,radius);
			},10);
		}
		
		window.onmouseup = function(e){
			mouseX = e.clientX;
			mouseY = e.clientY;
			clearInterval(timer);
			timer = null;
			ctx.clearRect(0,0,width,height);
			timer = setInterval(()=>{
				radius += step;
				if(radius >= maxRadius) {
					clearInterval(timer);
					timer = null;
					// ctx.clearRect(0,0,width,height);
					// drawStar(mouseX,mouseY,radius);
				}
				ctx.clearRect(0,0,width,height);
				drawStar(mouseX,mouseY,radius);
			},20);
		}
	</script>
	<script>
		// 五角星类的封装
		class Pentagram{
			constructor(x,y,r,pointNum){
				// x、y、r为绘制中心和垂心距，pointNum表顶点数
				// 五角星则五个顶点
				this.x = x;
				this.y = y;
				this.r = r;
				this.pointNum = pointNum;
				this.outerDeg = 2*Math.PI/pointNum,
				// this.innerDeg = (2*Math.PI/pointNum)/2,
				this.innerDeg = Math.PI/pointNum,
				//从π/2处的顶点位置开始绘制
				this.currentDeg = Math.PI/2;
				this.outerRadius = r,
				// innerRadius = outerRadius*Math.sin(innerDeg/2)/Math.sin(innerDeg);//
				this.innerRadius = r*Math.sin(Math.PI/pointNum/2)/Math.sin(Math.PI/pointNum);//
			}
			draw(){
				ctx.save();
				ctx.beginPath();
				// 设置绘制中心
				ctx.translate(this.x,this.y);
				// 只能有一个起点，
				ctx.moveTo(this.outerRadius*Math.cos(this.currentDeg),-this.outerRadius*Math.sin(this.currentDeg));
				
				for(let i = 0; i < this.pointNum; i++) {
					this.currentDeg += this.innerDeg;
					ctx.lineTo(this.innerRadius*Math.cos(this.currentDeg),-this.innerRadius*Math.sin(this.currentDeg));
					this.currentDeg += this.innerDeg;
					ctx.lineTo(this.outerRadius*Math.cos(this.currentDeg),-this.outerRadius*Math.sin(this.currentDeg));
					
				}
				ctx.closePath();
				ctx.lineWidth = 2;
				ctx.strokeStyle = grd;
				ctx.stroke();
				ctx.restore();
			}
		}
		
	// 使用方式
		// let star1 = new Pentagram(400,400,100,5);
		// star1.draw();
		// console.log(star1);
		
		
	</script>
</body>
</html>